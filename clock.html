<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Clock - Apple Style</title>
    <style>
        :root {
            --bg-color: #f5f5f7;
            --card-bg: #ffffff;
            --text-primary: #1d1d1f;
            --text-secondary: #86868b;
            --clock-face: #ffffff;
            --hand-color: #1d1d1f;
            --second-hand: #ff9500; /* Apple Orange */
            --shadow: 0 10px 30px rgba(0,0,0,0.05);
            --border-radius: 22px;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #000000;
                --card-bg: #1c1c1e;
                --text-primary: #f5f5f7;
                --text-secondary: #86868b;
                --clock-face: #2c2c2e;
                --hand-color: #ffffff;
                --shadow: 0 10px 30px rgba(0,0,0,0.2);
            }
        }

        body {
            margin: 0;
            padding: 40px 20px;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            transition: background-color 0.3s ease;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 50px;
        }

        h1 {
            font-size: 48px;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin: 0;
        }

        p.subtitle {
            color: var(--text-secondary);
            font-size: 19px;
            margin-top: 10px;
            font-weight: 400;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 24px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            transition: transform 0.2s ease;
        }

        .card:hover {
            transform: scale(1.02);
        }

        /* Analog Clock Styles */
        .clock-face {
            width: 160px;
            height: 160px;
            background-color: var(--clock-face);
            border-radius: 50%;
            position: relative;
            margin-bottom: 20px;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
        }

        .hand {
            position: absolute;
            bottom: 50%;
            left: 50%;
            transform-origin: bottom center;
            border-radius: 4px;
            z-index: 10;
        }

        .hand.hour {
            width: 4px;
            height: 45px;
            background-color: var(--hand-color);
        }

        .hand.minute {
            width: 3px;
            height: 65px;
            background-color: var(--hand-color);
        }

        .hand.second {
            width: 2px;
            height: 70px;
            background-color: var(--second-hand);
            z-index: 11;
        }

        .center-dot {
            width: 8px;
            height: 8px;
            background-color: var(--hand-color);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 12;
        }

        .center-dot.second-dot {
            width: 4px;
            height: 4px;
            background-color: var(--second-hand);
            z-index: 13;
        }

        /* Markers (Ticks) */
        .marker {
            position: absolute;
            width: 2px;
            height: 8px;
            background-color: #d1d1d6;
            left: 50%;
            top: 0;
            transform-origin: 50% 80px; /* Half of clock-face width */
        }
        
        .marker.quarter {
            width: 3px;
            height: 12px;
            background-color: var(--text-secondary);
        }

        /* Text Info */
        .city-name {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .timezone-name {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 15px;
        }

        .digital-time {
            font-size: 32px;
            font-weight: 300;
            font-feature-settings: "tnum";
            font-variant-numeric: tabular-nums;
            color: var(--text-primary);
        }

        .day-info {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 5px;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>世界时钟</h1>
            <p class="subtitle">当前各地时间概览</p>
        </header>

        <div class="grid" id="clock-grid">
            <!-- Clocks will be injected here via JavaScript -->
        </div>
    </div>

    <script>
        // 定义需要显示的城市和对应的 IANA 时区
        const cities = [
            { name: "北京", zone: "Asia/Shanghai", label: "CN" },
            { name: "库比蒂诺", zone: "America/Los_Angeles", label: "Apple Park" },
            { name: "纽约", zone: "America/New_York", label: "USA" },
            { name: "伦敦", zone: "Europe/London", label: "UK" },
            { name: "东京", zone: "Asia/Tokyo", label: "JP" },
            { name: "悉尼", zone: "Australia/Sydney", label: "AU" },
            { name: "巴黎", zone: "Europe/Paris", label: "FR" },
            { name: "迪拜", zone: "Asia/Dubai", label: "UAE" }
        ];

        const grid = document.getElementById('clock-grid');

        // 初始化时钟卡片
        function initClocks() {
            cities.forEach((city, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.id = `city-${index}`;
                
                // 生成表盘刻度
                let markersHtml = '';
                for (let i = 0; i < 12; i++) {
                    const isQuarter = i % 3 === 0;
                    const rotate = i * 30;
                    markersHtml += `<div class="marker ${isQuarter ? 'quarter' : ''}" style="transform: translateX(-50%) rotate(${rotate}deg)"></div>`;
                }

                card.innerHTML = `
                    <div class="timezone-name">${city.label}</div>
                    <div class="clock-face">
                        ${markersHtml}
                        <div class="hand hour" id="hour-${index}"></div>
                        <div class="hand minute" id="min-${index}"></div>
                        <div class="hand second" id="sec-${index}"></div>
                        <div class="center-dot"></div>
                        <div class="center-dot second-dot"></div>
                    </div>
                    <div class="city-name">${city.name}</div>
                    <div class="digital-time" id="time-${index}">--:--</div>
                    <div class="day-info" id="day-${index}">今天</div>
                `;
                grid.appendChild(card);
            });
        }

        // 更新时间逻辑
        function updateClocks() {
            const now = new Date();

            cities.forEach((city, index) => {
                // 使用 Intl API 获取特定时区的时间对象
                const options = { timeZone: city.zone, hour12: false, hour: 'numeric', minute: 'numeric', second: 'numeric', weekday: 'short' };
                const formatter = new Intl.DateTimeFormat('zh-CN', {
                    ...options,
                    year: 'numeric',
                    month: 'numeric',
                    day: 'numeric'
                });
                
                // 将格式化后的字符串转回各部分数据，或者重新解析
                // 为了精确计算指针角度，我们需要该时区的 H, M, S
                // 方法：利用 toLocaleString 获取字符串，再解析
                const timeStr = new Date().toLocaleString('en-US', { timeZone: city.zone });
                const cityDate = new Date(timeStr);

                const seconds = cityDate.getSeconds();
                const minutes = cityDate.getMinutes();
                const hours = cityDate.getHours();

                // 计算指针角度
                const secondsDegrees = ((seconds / 60) * 360);
                const minutesDegrees = ((minutes / 60) * 360) + ((seconds/60)*6);
                const hoursDegrees = ((hours / 12) * 360) + ((minutes/60)*30);

                // 更新指针 DOM
                document.getElementById(`sec-${index}`).style.transform = `translateX(-50%) rotate(${secondsDegrees}deg)`;
                document.getElementById(`min-${index}`).style.transform = `translateX(-50%) rotate(${minutesDegrees}deg)`;
                document.getElementById(`hour-${index}`).style.transform = `translateX(-50%) rotate(${hoursDegrees}deg)`;

                // 更新数字时间
                const displayTime = cityDate.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
                document.getElementById(`time-${index}`).textContent = displayTime;

                // 计算日期差异 (今天/明天/昨天)
                // 获取本地日期的天数和目标时区日期的天数比较
                const localDay = now.getDate();
                const targetDay = cityDate.getDate();
                let dayDiffText = "今天";
                
                // 简单的日期差判断 (注意：跨月/跨年时简单的 getDate 比较会有问题，这里做个简单处理)
                // 更严谨的方法是比较时间戳整除天数，但为了不依赖库，我们只显示相对星期几
                const weekday = new Intl.DateTimeFormat('zh-CN', { timeZone: city.zone, weekday: 'long' }).format(new Date());
                
                // 如果当前用户的本地时间和目标时间日期不同
                const localDateString = now.toLocaleDateString('en-US', { timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone });
                const targetDateString = now.toLocaleDateString('en-US', { timeZone: city.zone });
                
                if (localDateString !== targetDateString) {
                    // 判断是昨天还是明天
                    const diff = new Date(targetDateString) - new Date(localDateString);
                    if (diff > 0) dayDiffText = `明天, ${weekday}`;
                    else dayDiffText = `昨天, ${weekday}`;
                } else {
                    dayDiffText = `今天, ${weekday}`;
                }

                document.getElementById(`day-${index}`).textContent = dayDiffText;
            });

            requestAnimationFrame(updateClocks);
        }

        // 启动
        initClocks();
        // 使用 requestAnimationFrame 实现流畅动画，但为了性能也可以改用 setInterval
        setInterval(updateClocks, 1000);
        updateClocks(); // 立即执行一次

    </script>
</body>
</html>
